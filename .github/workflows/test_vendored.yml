name: Test vendored

on:
  schedule:
    # * is a special character in YAML so you have to quote this string
    - cron:  '0 2 * * *'

jobs:
  vendor:
    name: Vendored
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@f43a0e5ff2bd294095638e18286ca9a3d1956744 # v3.6.0
      - name: Set up Python 3.9
        uses: actions/setup-python@7f4fc3e22c37d6ff65e88745f38bd3157c663f7c # v4.9.1
        with:
          python-version: 3.9
      - name: Run check
        id: check_v
        run: python tools/check_vendored_modules.py --ci

      - name: Create PR updating vendored modules
        uses: peter-evans/create-pull-request@38e0b6e68b4c852a5500a94740f0e535e0d7ba54 # v4.2.4
        with:
          commit-message: Update vendored modules.
          branch: update-vendored-examples
          delete-branch: true
          title: "[Automatic] Update ${{ steps.check_v.outputs.vendored }} vendored module"
          body: |
            This PR is automatically created and updated by napari GitHub
            action cron to keep vendored modules up to date.

            It look like ${{ steps.check_v.outputs.vendored }} has a new version.
